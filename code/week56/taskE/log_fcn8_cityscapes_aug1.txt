../../config/cityscapes_segmentation_fcn8.py
dataset_config_path /datatmp/Datasets/segmentation/Datasets/segmentation/cityscapes/config.py
 ---> Init experiment: FCN8 <---

 > Reading training set...
   Computing normalization constants from training set...
   Found 2975 images belonging to 20 classes

 > Reading validation set...
   Found 500 images belonging to 20 classes

 > Reading testing set...
   Found 1525 images belonging to 20 classes

 > Creating optimizer...
   Optimizer: rmsprop. Lr: 0.0001. Rho: 0.9, epsilon=1e-8, clipnorm=10

 > Building model...
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
input_1 (InputLayer)             (None, None, None, 3) 0                                            
____________________________________________________________________________________________________
pad100 (ZeroPadding2D)           (None, None, None, 3) 0           input_1[0][0]                    
____________________________________________________________________________________________________
conv1_1 (Convolution2D)          (None, None, None, 64 1792        pad100[0][0]                     
____________________________________________________________________________________________________
conv1_2 (Convolution2D)          (None, None, None, 64 36928       conv1_1[0][0]                    
____________________________________________________________________________________________________
pool1 (MaxPooling2D)             (None, None, None, 64 0           conv1_2[0][0]                    
____________________________________________________________________________________________________
conv2_1 (Convolution2D)          (None, None, None, 12 73856       pool1[0][0]                      
____________________________________________________________________________________________________
conv2_2 (Convolution2D)          (None, None, None, 12 147584      conv2_1[0][0]                    
____________________________________________________________________________________________________
pool2 (MaxPooling2D)             (None, None, None, 12 0           conv2_2[0][0]                    
____________________________________________________________________________________________________
conv3_1 (Convolution2D)          (None, None, None, 25 295168      pool2[0][0]                      
____________________________________________________________________________________________________
conv3_2 (Convolution2D)          (None, None, None, 25 590080      conv3_1[0][0]                    
____________________________________________________________________________________________________
conv3_3 (Convolution2D)          (None, None, None, 25 590080      conv3_2[0][0]                    
____________________________________________________________________________________________________
pool3 (MaxPooling2D)             (None, None, None, 25 0           conv3_3[0][0]                    
____________________________________________________________________________________________________
conv4_1 (Convolution2D)          (None, None, None, 51 1180160     pool3[0][0]                      
____________________________________________________________________________________________________
conv4_2 (Convolution2D)          (None, None, None, 51 2359808     conv4_1[0][0]                    
____________________________________________________________________________________________________
conv4_3 (Convolution2D)          (None, None, None, 51 2359808     conv4_2[0][0]                    
____________________________________________________________________________________________________
pool4 (MaxPooling2D)             (None, None, None, 51 0           conv4_3[0][0]                    
____________________________________________________________________________________________________
conv5_1 (Convolution2D)          (None, None, None, 51 2359808     pool4[0][0]                      
____________________________________________________________________________________________________
conv5_2 (Convolution2D)          (None, None, None, 51 2359808     conv5_1[0][0]                    
____________________________________________________________________________________________________
conv5_3 (Convolution2D)          (None, None, None, 51 2359808     conv5_2[0][0]                    
____________________________________________________________________________________________________
pool5 (MaxPooling2D)             (None, None, None, 51 0           conv5_3[0][0]                    
____________________________________________________________________________________________________
fc6 (Convolution2D)              (None, None, None, 40 102764544   pool5[0][0]                      
____________________________________________________________________________________________________
dropout_1 (Dropout)              (None, None, None, 40 0           fc6[0][0]                        
____________________________________________________________________________________________________
fc7 (Convolution2D)              (None, None, None, 40 16781312    dropout_1[0][0]                  
____________________________________________________________________________________________________
dropout_2 (Dropout)              (None, None, None, 40 0           fc7[0][0]                        
____________________________________________________________________________________________________
score_pool4 (Convolution2D)      (None, None, None, 19 9747        pool4[0][0]                      
____________________________________________________________________________________________________
score_fr (Convolution2D)         (None, None, None, 19 77843       dropout_2[0][0]                  
____________________________________________________________________________________________________
score_pool4_crop (CropLayer2D)   ((None,), None, None, 0           score_pool4[0][0]                
____________________________________________________________________________________________________
score2 (Deconvolution2D)         (None, None, None, 19 5795        score_fr[0][0]                   
____________________________________________________________________________________________________
score_pool3 (Convolution2D)      (None, None, None, 19 4883        pool3[0][0]                      
____________________________________________________________________________________________________
score_fused (Merge)              ((None,), None, None, 0           score_pool4_crop[0][0]           
                                                                   score2[0][0]                     
____________________________________________________________________________________________________
score_pool3_crop (CropLayer2D)   ((None,), None, None, 0           score_pool3[0][0]                
____________________________________________________________________________________________________
score4 (Deconvolution2D)         ((None,), None, None, 5795        score_fused[0][0]                
____________________________________________________________________________________________________
score_final (Merge)              ((None,), None, None, 0           score_pool3_crop[0][0]           
                                                                   score4[0][0]                     
____________________________________________________________________________________________________
upsample (Deconvolution2D)       ((None,), None, None, 92416       score_final[0][0]                
____________________________________________________________________________________________________
score (CropLayer2D)              (((None,),), None, No 0           upsample[0][0]                   
____________________________________________________________________________________________________
ndsoftmax_1 (NdSoftmax)          (((None,),), None, No 0           score[0][0]                      
====================================================================================================
Total params: 134,457,023
Trainable params: 134,457,023
Non-trainable params: 0
____________________________________________________________________________________________________
   Model: fcn8
   Model: fcn8

 > Creating callbacks...
   Jaccard metric
   Early stopping
   Model Checkpoint
   Plot per epoch

 > Training the model...
Epoch 1/2
 5/50 [==>...........................] - ETA: 895s - loss: 2.9444 - acc: 0.0481 - jaccard: 0.012310/50 [=====>........................] - ETA: 399s - loss: 2.9441 - acc: 0.0676 - jaccard: 0.015315/50 [========>.....................] - ETA: 234s - loss: 2.9417 - acc: 0.0801 - jaccard: 0.015520/50 [===========>..................] - ETA: 151s - loss: 3.0538 - acc: 0.0812 - jaccard: 0.015825/50 [==============>...............] - ETA: 101s - loss: 3.0292 - acc: 0.0917 - jaccard: 0.016730/50 [=================>............] - ETA: 68s - loss: 3.0131 - acc: 0.0998 - jaccard: 0.0175 35/50 [====================>.........] - ETA: 43s - loss: 3.0010 - acc: 0.1064 - jaccard: 0.018140/50 [=======================>......] - ETA: 25s - loss: 2.9919 - acc: 0.1108 - jaccard: 0.018445/50 [==========================>...] - ETA: 11s - loss: 2.9842 - acc: 0.1143 - jaccard: 0.018850/50 [==============================] - 113s - loss: 2.9771 - acc: 0.1142 - jaccard: 0.0193 - val_loss: 2.8733 - val_acc: 0.1077 - val_jaccard: 0.0218 - 0_jacc: 0.1267 - 0_val_jacc: 0.1108 - 1_jacc: 0.0124 - 1_val_jacc: 0.0178 - 2_jacc: 0.0776 - 2_val_jacc: 0.0852 - 3_jacc: 0.0022 - 3_val_jacc: 0.0032 - 4_jacc: 0.0034 - 4_val_jacc: 0.0093 - 5_jacc: 0.0088 - 5_val_jacc: 0.0170 - 6_jacc: 0.0014 - 6_val_jacc: 0.0019 - 7_jacc: 0.0031 - 7_val_jacc: 0.0038 - 8_jacc: 0.0529 - 8_val_jacc: 0.0621 - 9_jacc: 0.0085 - 9_val_jacc: 0.0085 - 10_jacc: 0.0272 - 10_val_jacc: 0.0301 - 11_jacc: 0.0041 - 11_val_jacc: 0.0049 - 12_jacc: 0.0017 - 12_val_jacc: 0.0011 - 13_jacc: 0.0581 - 13_val_jacc: 0.0388 - 14_jacc: 0.0000e+00 - 14_val_jacc: 0.0097 - 15_jacc: 9.9218e-05 - 15_val_jacc: 0.0033 - 16_jacc: 0.0063 - 16_val_jacc: 0.0017 - 17_jacc: 4.8175e-04 - 17_val_jacc: 0.0025 - 18_jacc: 0.0044 - 18_val_jacc: 0.0018
Epoch 2/2
 5/50 [==>...........................] - ETA: 4s - loss: 2.9037 - acc: 0.0926 - jaccard: 0.018710/50 [=====>........................] - ETA: 4s - loss: 2.8853 - acc: 0.1006 - jaccard: 0.019815/50 [========>.....................] - ETA: 3s - loss: 2.8812 - acc: 0.1079 - jaccard: 0.020520/50 [===========>..................] - ETA: 3s - loss: 2.8932 - acc: 0.1056 - jaccard: 0.020925/50 [==============>...............] - ETA: 2s - loss: 2.8937 - acc: 0.1165 - jaccard: 0.021530/50 [=================>............] - ETA: 2s - loss: 2.8905 - acc: 0.1217 - jaccard: 0.021735/50 [====================>.........] - ETA: 1s - loss: 2.8690 - acc: 0.1289 - jaccard: 0.021640/50 [=======================>......] - ETA: 1s - loss: 2.8542 - acc: 0.1328 - jaccard: 0.021745/50 [==========================>...] - ETA: 0s - loss: 2.8526 - acc: 0.1415 - jaccard: 0.022250/50 [==============================] - 14s - loss: 2.8514 - acc: 0.1427 - jaccard: 0.0226 - val_loss: 2.6409 - val_acc: 0.1940 - val_jaccard: 0.0273 - 0_jacc: 0.1549 - 0_val_jacc: 0.2038 - 1_jacc: 0.0200 - 1_val_jacc: 0.0146 - 2_jacc: 0.0966 - 2_val_jacc: 0.1248 - 3_jacc: 0.0074 - 3_val_jacc: 0.0044 - 4_jacc: 0.0083 - 4_val_jacc: 0.0096 - 5_jacc: 0.0116 - 5_val_jacc: 0.0115 - 6_jacc: 8.2449e-04 - 6_val_jacc: 0.0028 - 7_jacc: 0.0033 - 7_val_jacc: 0.0053 - 8_jacc: 0.0554 - 8_val_jacc: 0.0693 - 9_jacc: 0.0115 - 9_val_jacc: 0.0051 - 10_jacc: 0.0190 - 10_val_jacc: 0.0203 - 11_jacc: 0.0099 - 11_val_jacc: 0.0062 - 12_jacc: 0.0054 - 12_val_jacc: 0.0020 - 13_jacc: 0.0519 - 13_val_jacc: 0.0276 - 14_jacc: 0.0049 - 14_val_jacc: 9.8487e-05 - 15_jacc: 4.6156e-04 - 15_val_jacc: 0.0052 - 16_jacc: 0.0000e+00 - 16_val_jacc: 7.1965e-04 - 17_jacc: 0.0069 - 17_val_jacc: 9.6034e-04 - 18_jacc: 0.0062 - 18_val_jacc: 0.0045
   Training finished.

 > Testing the model...
   Testing time: 6.82765388489. FPS: 4.39389583974. Seconds per Frame: 0.22758846283
   Test metrics: 
      U9: 12212.6666667
      U8: 241404.666667
      U5: 50466.6666667
      U4: 53282.0
      U7: 25426.6666667
      U6: 17535.3333333
      U1: 121503.333333
      U0: 602218.333333
      U3: 21696.3333333
      U2: 452795.666667
      U18: 24619.0
      U11: 52375.3333333
      U10: 77255.0
      U13: 162118.666667
      U12: 18139.3333333
      U15: 10977.3333333
      U14: 17825.0
      U17: 26164.6666667
      U16: 23342.6666667
      I9: 32.3333333333
      I8: 15072.6666667
      I1: 2164.0
      I0: 112374.333333
      I3: 90.3333333333
      I2: 60674.0
      I5: 570.0
      I4: 614.333333333
      I7: 145.333333333
      I6: 23.3333333333
      I18: 121.666666667
      I15: 0.666666666667
      I14: 19.6666666667
      I17: 19.3333333333
      I16: 95.6666666667
      I11: 438.0
      I10: 1487.0
      I13: 5031.66666667
      I12: 33.0
      acc: 0.180163964629
      loss: 2.68288040161
    0 (     road      ): Jacc:  18.66
    1 (   sidewalk    ): Jacc:   1.78
    2 (   building    ): Jacc:  13.40
    3 (     wall      ): Jacc:   0.42
    4 (     fence     ): Jacc:   1.15
    5 (     pole      ): Jacc:   1.13
    6 ( traffic light ): Jacc:   0.13
    7 ( traffic sign  ): Jacc:   0.57
    8 (  vegetation   ): Jacc:   6.24
    9 (    terrain    ): Jacc:   0.26
   10 (      sky      ): Jacc:   1.92
   11 (    person     ): Jacc:   0.84
   12 (     rider     ): Jacc:   0.18
   13 (      car      ): Jacc:   3.10
   14 (     truck     ): Jacc:   0.11
   15 (      bus      ): Jacc:   0.01
   16 (     train     ): Jacc:   0.41
   17 (  motorcycle   ): Jacc:   0.07
   18 (    bicycle    ): Jacc:   0.49
   Jaccard mean: 0.0267862583052

 > Testing the model...
   Testing time: 6.65671491623. FPS: 4.50672747407. Seconds per Frame: 0.221890497208
   Test metrics: 
      U9: 0.0
      U8: 0.0
      U5: 0.0
      U4: 0.0
      U7: 0.0
      U6: 0.0
      U1: 0.0
      U0: 0.0
      U3: 0.0
      U2: 0.0
      U18: 0.0
      U11: 0.0
      U10: 0.0
      U13: 0.0
      U12: 0.0
      U15: 0.0
      U14: 0.0
      U17: 0.0
      U16: 0.0
      I9: 0.0
      I8: 0.0
      I1: 0.0
      I0: 0.0
      I3: 0.0
      I2: 0.0
      I5: 0.0
      I4: 0.0
      I7: 0.0
      I6: 0.0
      I18: 0.0
      I15: 0.0
      I14: 0.0
      I17: 0.0
      I16: 0.0
      I11: 0.0
      I10: 0.0
      I13: 0.0
      I12: 0.0
      acc: nan
      loss: nan
    0 (     road      ): Jacc:    nan
    1 (   sidewalk    ): Jacc:    nan
    2 (   building    ): Jacc:    nan
    3 (     wall      ): Jacc:    nan
    4 (     fence     ): Jacc:    nan
    5 (     pole      ): Jacc:    nan
    6 ( traffic light ): Jacc:    nan
    7 ( traffic sign  ): Jacc:    nan
    8 (  vegetation   ): Jacc:    nan
    9 (    terrain    ): Jacc:    nan
   10 (      sky      ): Jacc:    nan
   11 (    person     ): Jacc:    nan
   12 (     rider     ): Jacc:    nan
   13 (      car      ): Jacc:    nan
   14 (     truck     ): Jacc:    nan
   15 (      bus      ): Jacc:    nan
   16 (     train     ): Jacc:    nan
   17 (  motorcycle   ): Jacc:    nan
   18 (    bicycle    ): Jacc:    nan
   Jaccard mean: nan
Predict method not implemented.
Predict method not implemented.
 ---> Finish experiment: FCN8 <---

 > Copying model and other training files to /data/master/Experiments/cityscapes/FCN8
