../../config/cityscapes_segmentation_fcn8.py
dataset_config_path /datatmp/Datasets/segmentation/Datasets/segmentation/cityscapes/config.py
 ---> Init experiment: FCN8_aug <---

 > Reading training set...
   Computing normalization constants from training set...
   Found 2975 images belonging to 20 classes

 > Reading validation set...
   Found 500 images belonging to 20 classes

 > Reading testing set...
   Found 1525 images belonging to 20 classes

 > Creating optimizer...
   Optimizer: rmsprop. Lr: 0.0001. Rho: 0.9, epsilon=1e-8, clipnorm=10

 > Building model...
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
input_1 (InputLayer)             (None, None, None, 3) 0                                            
____________________________________________________________________________________________________
pad100 (ZeroPadding2D)           (None, None, None, 3) 0           input_1[0][0]                    
____________________________________________________________________________________________________
conv1_1 (Convolution2D)          (None, None, None, 64 1792        pad100[0][0]                     
____________________________________________________________________________________________________
conv1_2 (Convolution2D)          (None, None, None, 64 36928       conv1_1[0][0]                    
____________________________________________________________________________________________________
pool1 (MaxPooling2D)             (None, None, None, 64 0           conv1_2[0][0]                    
____________________________________________________________________________________________________
conv2_1 (Convolution2D)          (None, None, None, 12 73856       pool1[0][0]                      
____________________________________________________________________________________________________
conv2_2 (Convolution2D)          (None, None, None, 12 147584      conv2_1[0][0]                    
____________________________________________________________________________________________________
pool2 (MaxPooling2D)             (None, None, None, 12 0           conv2_2[0][0]                    
____________________________________________________________________________________________________
conv3_1 (Convolution2D)          (None, None, None, 25 295168      pool2[0][0]                      
____________________________________________________________________________________________________
conv3_2 (Convolution2D)          (None, None, None, 25 590080      conv3_1[0][0]                    
____________________________________________________________________________________________________
conv3_3 (Convolution2D)          (None, None, None, 25 590080      conv3_2[0][0]                    
____________________________________________________________________________________________________
pool3 (MaxPooling2D)             (None, None, None, 25 0           conv3_3[0][0]                    
____________________________________________________________________________________________________
conv4_1 (Convolution2D)          (None, None, None, 51 1180160     pool3[0][0]                      
____________________________________________________________________________________________________
conv4_2 (Convolution2D)          (None, None, None, 51 2359808     conv4_1[0][0]                    
____________________________________________________________________________________________________
conv4_3 (Convolution2D)          (None, None, None, 51 2359808     conv4_2[0][0]                    
____________________________________________________________________________________________________
pool4 (MaxPooling2D)             (None, None, None, 51 0           conv4_3[0][0]                    
____________________________________________________________________________________________________
conv5_1 (Convolution2D)          (None, None, None, 51 2359808     pool4[0][0]                      
____________________________________________________________________________________________________
conv5_2 (Convolution2D)          (None, None, None, 51 2359808     conv5_1[0][0]                    
____________________________________________________________________________________________________
conv5_3 (Convolution2D)          (None, None, None, 51 2359808     conv5_2[0][0]                    
____________________________________________________________________________________________________
pool5 (MaxPooling2D)             (None, None, None, 51 0           conv5_3[0][0]                    
____________________________________________________________________________________________________
fc6 (Convolution2D)              (None, None, None, 40 102764544   pool5[0][0]                      
____________________________________________________________________________________________________
dropout_1 (Dropout)              (None, None, None, 40 0           fc6[0][0]                        
____________________________________________________________________________________________________
fc7 (Convolution2D)              (None, None, None, 40 16781312    dropout_1[0][0]                  
____________________________________________________________________________________________________
dropout_2 (Dropout)              (None, None, None, 40 0           fc7[0][0]                        
____________________________________________________________________________________________________
score_pool4 (Convolution2D)      (None, None, None, 19 9747        pool4[0][0]                      
____________________________________________________________________________________________________
score_fr (Convolution2D)         (None, None, None, 19 77843       dropout_2[0][0]                  
____________________________________________________________________________________________________
score_pool4_crop (CropLayer2D)   ((None,), None, None, 0           score_pool4[0][0]                
____________________________________________________________________________________________________
score2 (Deconvolution2D)         (None, None, None, 19 5795        score_fr[0][0]                   
____________________________________________________________________________________________________
score_pool3 (Convolution2D)      (None, None, None, 19 4883        pool3[0][0]                      
____________________________________________________________________________________________________
score_fused (Merge)              ((None,), None, None, 0           score_pool4_crop[0][0]           
                                                                   score2[0][0]                     
____________________________________________________________________________________________________
score_pool3_crop (CropLayer2D)   ((None,), None, None, 0           score_pool3[0][0]                
____________________________________________________________________________________________________
score4 (Deconvolution2D)         ((None,), None, None, 5795        score_fused[0][0]                
____________________________________________________________________________________________________
score_final (Merge)              ((None,), None, None, 0           score_pool3_crop[0][0]           
                                                                   score4[0][0]                     
____________________________________________________________________________________________________
upsample (Deconvolution2D)       ((None,), None, None, 92416       score_final[0][0]                
____________________________________________________________________________________________________
score (CropLayer2D)              (((None,),), None, No 0           upsample[0][0]                   
____________________________________________________________________________________________________
ndsoftmax_1 (NdSoftmax)          (((None,),), None, No 0           score[0][0]                      
====================================================================================================
Total params: 134,457,023
Trainable params: 134,457,023
Non-trainable params: 0
____________________________________________________________________________________________________
   Model: fcn8
   Model: fcn8

 > Creating callbacks...
   Jaccard metric
   Early stopping
   Model Checkpoint
   Plot per epoch

 > Training the model...
Epoch 1/2
 5/50 [==>...........................] - ETA: 905s - loss: 2.9444 - acc: 0.0581 - jaccard: 0.014210/50 [=====>........................] - ETA: 404s - loss: 2.9441 - acc: 0.0682 - jaccard: 0.016015/50 [========>.....................] - ETA: 237s - loss: 2.9427 - acc: 0.0764 - jaccard: 0.015920/50 [===========>..................] - ETA: 153s - loss: 2.9411 - acc: 0.0768 - jaccard: 0.015925/50 [==============>...............] - ETA: 102s - loss: 2.9395 - acc: 0.0887 - jaccard: 0.016830/50 [=================>............] - ETA: 68s - loss: 2.9383 - acc: 0.0996 - jaccard: 0.0178 35/50 [====================>.........] - ETA: 44s - loss: 2.9361 - acc: 0.1070 - jaccard: 0.018640/50 [=======================>......] - ETA: 26s - loss: 2.9330 - acc: 0.1108 - jaccard: 0.018945/50 [==========================>...] - ETA: 11s - loss: 2.9245 - acc: 0.1122 - jaccard: 0.019050/50 [==============================] - 113s - loss: 3.0978 - acc: 0.1114 - jaccard: 0.0194 - val_loss: 2.8811 - val_acc: 0.1578 - val_jaccard: 0.0254 - 0_jacc: 0.0990 - 0_val_jacc: 0.1507 - 1_jacc: 0.0136 - 1_val_jacc: 0.0091 - 2_jacc: 0.0919 - 2_val_jacc: 0.1145 - 3_jacc: 0.0016 - 3_val_jacc: 0.0032 - 4_jacc: 0.0044 - 4_val_jacc: 0.0059 - 5_jacc: 0.0087 - 5_val_jacc: 0.0118 - 6_jacc: 0.0014 - 6_val_jacc: 0.0017 - 7_jacc: 0.0038 - 7_val_jacc: 0.0036 - 8_jacc: 0.0667 - 8_val_jacc: 0.0796 - 9_jacc: 0.0050 - 9_val_jacc: 0.0073 - 10_jacc: 0.0250 - 10_val_jacc: 0.0273 - 11_jacc: 0.0051 - 11_val_jacc: 0.0047 - 12_jacc: 0.0012 - 12_val_jacc: 0.0012 - 13_jacc: 0.0622 - 13_val_jacc: 0.0438 - 14_jacc: 0.0000e+00 - 14_val_jacc: 0.0078 - 15_jacc: 1.1593e-04 - 15_val_jacc: 0.0038 - 16_jacc: 0.0044 - 16_val_jacc: 0.0015 - 17_jacc: 3.9593e-04 - 17_val_jacc: 0.0025 - 18_jacc: 0.0043 - 18_val_jacc: 0.0019
Epoch 2/2
 5/50 [==>...........................] - ETA: 4s - loss: 2.9087 - acc: 0.1301 - jaccard: 0.020210/50 [=====>........................] - ETA: 4s - loss: 2.8999 - acc: 0.1490 - jaccard: 0.022615/50 [========>.....................] - ETA: 3s - loss: 2.8977 - acc: 0.1548 - jaccard: 0.023220/50 [===========>..................] - ETA: 3s - loss: 2.8964 - acc: 0.1480 - jaccard: 0.023325/50 [==============>...............] - ETA: 2s - loss: 2.8865 - acc: 0.1526 - jaccard: 0.023530/50 [=================>............] - ETA: 2s - loss: 2.8726 - acc: 0.1527 - jaccard: 0.023735/50 [====================>.........] - ETA: 1s - loss: 2.8404 - acc: 0.1556 - jaccard: 0.023340/50 [=======================>......] - ETA: 1s - loss: 2.8262 - acc: 0.1606 - jaccard: 0.023445/50 [==========================>...] - ETA: 0s - loss: 2.7957 - acc: 0.1649 - jaccard: 0.023650/50 [==============================] - 14s - loss: 2.7882 - acc: 0.1671 - jaccard: 0.0240 - val_loss: 2.7205 - val_acc: 0.2416 - val_jaccard: 0.0284 - 0_jacc: 0.1718 - 0_val_jacc: 0.2405 - 1_jacc: 0.0112 - 1_val_jacc: 0.0069 - 2_jacc: 0.1134 - 2_val_jacc: 0.1459 - 3_jacc: 0.0050 - 3_val_jacc: 0.0020 - 4_jacc: 0.0045 - 4_val_jacc: 0.0035 - 5_jacc: 0.0084 - 5_val_jacc: 0.0045 - 6_jacc: 0.0011 - 6_val_jacc: 0.0028 - 7_jacc: 0.0023 - 7_val_jacc: 0.0022 - 8_jacc: 0.0583 - 8_val_jacc: 0.0690 - 9_jacc: 0.0095 - 9_val_jacc: 0.0033 - 10_jacc: 0.0169 - 10_val_jacc: 0.0136 - 11_jacc: 0.0100 - 11_val_jacc: 0.0062 - 12_jacc: 0.0024 - 12_val_jacc: 0.0016 - 13_jacc: 0.0579 - 13_val_jacc: 0.0273 - 14_jacc: 0.0042 - 14_val_jacc: 2.8675e-04 - 15_jacc: 5.4491e-04 - 15_val_jacc: 0.0037 - 16_jacc: 0.0000e+00 - 16_val_jacc: 8.9749e-04 - 17_jacc: 0.0040 - 17_val_jacc: 0.0012 - 18_jacc: 0.0050 - 18_val_jacc: 0.0037
   Training finished.

 > Testing the model...
   Testing time: 6.92117404938. FPS: 4.33452471878. Seconds per Frame: 0.230705801646
   Test metrics: 
      U9: 8976.66666667
      U8: 231946.333333
      U5: 31475.6666667
      U4: 38683.6666667
      U7: 15311.3333333
      U6: 7698.33333333
      U1: 105055.666667
      U0: 641366.666667
      U3: 9667.66666667
      U2: 549544.333333
      U18: 13158.3333333
      U11: 51462.3333333
      U10: 56887.0
      U13: 163505.0
      U12: 9541.0
      U15: 6229.33333333
      U14: 4663.0
      U17: 6734.0
      U16: 8710.0
      I9: 18.6666666667
      I8: 14615.6666667
      I1: 775.666666667
      I0: 140159.333333
      I3: 23.6666666667
      I2: 87475.6666667
      I5: 131.333333333
      I4: 133.333333333
      I7: 38.6666666667
      I6: 3.66666666667
      I18: 47.6666666667
      I15: 0.666666666667
      I14: 6.0
      I17: 4.66666666667
      I16: 17.3333333333
      I11: 461.666666667
      I10: 741.333333333
      I13: 5080.0
      I12: 14.6666666667
      acc: 0.226173847914
      loss: 2.73816537857
    0 (     road      ): Jacc:  21.85
    1 (   sidewalk    ): Jacc:   0.74
    2 (   building    ): Jacc:  15.92
    3 (     wall      ): Jacc:   0.24
    4 (     fence     ): Jacc:   0.34
    5 (     pole      ): Jacc:   0.42
    6 ( traffic light ): Jacc:   0.05
    7 ( traffic sign  ): Jacc:   0.25
    8 (  vegetation   ): Jacc:   6.30
    9 (    terrain    ): Jacc:   0.21
   10 (      sky      ): Jacc:   1.30
   11 (    person     ): Jacc:   0.90
   12 (     rider     ): Jacc:   0.15
   13 (      car      ): Jacc:   3.11
   14 (     truck     ): Jacc:   0.13
   15 (      bus      ): Jacc:   0.01
   16 (     train     ): Jacc:   0.20
   17 (  motorcycle   ): Jacc:   0.07
   18 (    bicycle    ): Jacc:   0.36
   Jaccard mean: 0.027661284742

 > Testing the model...
   Testing time: 6.72879886627. FPS: 4.45844802263. Seconds per Frame: 0.224293295542
   Test metrics: 
      U9: 0.0
      U8: 0.0
      U5: 0.0
      U4: 0.0
      U7: 0.0
      U6: 0.0
      U1: 0.0
      U0: 0.0
      U3: 0.0
      U2: 0.0
      U18: 0.0
      U11: 0.0
      U10: 0.0
      U13: 0.0
      U12: 0.0
      U15: 0.0
      U14: 0.0
      U17: 0.0
      U16: 0.0
      I9: 0.0
      I8: 0.0
      I1: 0.0
      I0: 0.0
      I3: 0.0
      I2: 0.0
      I5: 0.0
      I4: 0.0
      I7: 0.0
      I6: 0.0
      I18: 0.0
      I15: 0.0
      I14: 0.0
      I17: 0.0
      I16: 0.0
      I11: 0.0
      I10: 0.0
      I13: 0.0
      I12: 0.0
      acc: nan
      loss: nan
    0 (     road      ): Jacc:    nan
    1 (   sidewalk    ): Jacc:    nan
    2 (   building    ): Jacc:    nan
    3 (     wall      ): Jacc:    nan
    4 (     fence     ): Jacc:    nan
    5 (     pole      ): Jacc:    nan
    6 ( traffic light ): Jacc:    nan
    7 ( traffic sign  ): Jacc:    nan
    8 (  vegetation   ): Jacc:    nan
    9 (    terrain    ): Jacc:    nan
   10 (      sky      ): Jacc:    nan
   11 (    person     ): Jacc:    nan
   12 (     rider     ): Jacc:    nan
   13 (      car      ): Jacc:    nan
   14 (     truck     ): Jacc:    nan
   15 (      bus      ): Jacc:    nan
   16 (     train     ): Jacc:    nan
   17 (  motorcycle   ): Jacc:    nan
   18 (    bicycle    ): Jacc:    nan
   Jaccard mean: nan
Predict method not implemented.
Predict method not implemented.
 ---> Finish experiment: FCN8_aug <---

 > Copying model and other training files to /data/master/Experiments/cityscapes/FCN8_aug
